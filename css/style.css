    <style>
        :root {
            --bg-body: #f0f2f5; --bg-card: #ffffff; --text-main: #2c3e50; --text-sub: #666666; --text-value: #2c3e50;
            --border-color: #e0e0e0; --shadow: rgba(0,0,0,0.05);
            --warn-bg: #fff3cd; --warn-text: #856404; --warn-border: #ffc107;
            --crit-bg: #f8d7da; --crit-text: #721c24; --crit-border: #dc3545;
            --run-bg:  #d1e7dd; --run-text:  #0f5132; --run-border:  #198754;
            --gauge-good: #28a745; --gauge-warn: #ffc107; --gauge-bad: #dc3545; --gauge-bg: #e9ecef;
        }
        [data-theme="dark"] {
            --bg-body: #121212; --bg-card: #1e1e1e; --text-main: #e0e0e0; --text-sub: #aaaaaa; --text-value: #ffffff;
            --border-color: #333333; --shadow: rgba(0,0,0,0.5);
            --warn-bg: #423605; --warn-text: #ffda6a; --warn-border: #997404;
            --crit-bg: #4c1116; --crit-text: #ff8592; --crit-border: #a81624;
            --run-bg:  #051b11; --run-text:  #75b798; --run-border:  #198754;
            --gauge-bg: #333;
        }

        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: var(--bg-body); color: var(--text-main); margin: 0; padding: 0; transition: background 0.3s; }
        .container { max-width: 100%; padding: 10px; }

        .page-header { background: var(--bg-card); padding: 8px 15px; border-radius: 6px; box-shadow: 0 2px 5px var(--shadow); display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-left: 5px solid #007bff; flex-wrap: wrap; gap: 10px; }
        h1 { color: var(--text-main); margin: 0; font-size: 1.2rem; letter-spacing: 1px; }
        .header-right { display: flex; align-items: center; gap: 8px; }
        
        button.btn-ctrl { background: #007bff; color: white; border: none; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 0.8rem; display: flex; align-items: center; gap: 4px; }
        button.btn-ctrl:hover { opacity: 0.9; }
        .btn-report { background: #17a2b8; }
        .btn-excel { background: #28a745; }
        .btn-print { background: #6c757d; }

        .status-box { font-size: 0.75rem; color: var(--text-sub); background: var(--border-color); padding: 3px 8px; border-radius: 10px; font-weight: bold; }

        #app { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 10px; align-items: start; }
        .system-group { background: var(--bg-card); border-radius: 10px; padding: 10px; box-shadow: 0 1px 3px var(--shadow); border: 1px solid var(--border-color); }
        .system-title { font-size: 1rem; color: #fff; margin-bottom: 10px; padding: 6px 15px; border-radius: 50px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .system-title span { background: rgba(255,255,255,0.25); color: #fff; font-size: 0.75rem; padding: 2px 8px; border-radius: 10px; font-weight: bold; }

        .group-d01 .system-title { background: linear-gradient(135deg, #007bff, #0056b3); }
        .group-d02 .system-title { background: linear-gradient(135deg, #20c997, #198754); }
        .group-wm01 .system-title { background: linear-gradient(135deg, #17a2b8, #117a8b); }
        .group-wm02 .system-title { background: linear-gradient(135deg, #6f42c1, #59359a); }
        .group-wm05 .system-title { background: linear-gradient(135deg, #fd7e14, #d35400); }
        .group-cds .system-title { background: linear-gradient(135deg, #e83e8c, #c2175b); }
        .group-acc .system-title { background: linear-gradient(135deg, #343a40, #212529); }

        .inner-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .card { background: var(--bg-body); border-radius: 6px; padding: 6px 10px; border: 1px solid var(--border-color); border-top: 3px solid #ccc; position: relative; transition: background-color 0.3s; }
        .group-d01 .card { border-top-color: #007bff; } .group-wm01 .card { border-top-color: #17a2b8; } .group-wm02 .card { border-top-color: #6f42c1; }
        .group-wm05 .card { border-top-color: #fd7e14; } .group-d02 .card { border-top-color: #20c997; } .group-cds .card { border-top-color: #e83e8c; } .group-acc .card { border-top-color: #343a40; }

        .card.status-running { background-color: var(--run-bg); border-top-color: var(--run-border) !important; animation: pulse-green 3s infinite; }
        .card.status-running .value, .card.status-running .tag-name { color: var(--run-text); }
        .card.status-warning { background-color: var(--warn-bg); border-top-color: var(--warn-border) !important; animation: pulse-orange 2s infinite; }
        .card.status-warning .value, .card.status-warning .tag-name { color: var(--warn-text); }
        .card.status-critical { background-color: var(--crit-bg); border-top-color: var(--crit-border) !important; animation: pulse-red 1.5s infinite; }
        .card.status-critical .value, .card.status-critical .tag-name { color: var(--crit-text); font-weight: 900; }
        
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4); } 70% { box-shadow: 0 0 0 3px rgba(220, 53, 69, 0); } 100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); } }
        @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(25, 135, 84, 0.2); } 50% { box-shadow: 0 0 0 2px rgba(25, 135, 84, 0); } 100% { box-shadow: 0 0 0 0 rgba(25, 135, 84, 0); } }

        .card-header { margin-bottom: 2px; border-bottom: 1px solid rgba(0,0,0,0.05); padding-bottom: 2px; display: flex; justify-content: space-between; align-items: center; }
        .tag-name { font-size: 0.8rem; color: var(--text-main); font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 65%; }
        .tag-id { font-size: 0.65rem; color: var(--text-sub); font-family: Consolas, monospace; opacity: 0.7; } 
        .data-row { display: flex; align-items: baseline; justify-content: flex-end; margin-top: 2px; margin-bottom: 4px; }
        .value { font-size: 1.4rem; font-weight: bold; color: var(--text-value); font-family: 'Arial', sans-serif; line-height: 1; }
        .unit { font-size: 0.7rem; color: var(--text-sub); margin-left: 2px; }
        
        .gauge-container { height: 5px; width: 100%; background: var(--gauge-bg); border-radius: 3px; position: relative; display: flex; overflow: visible; margin-top: 2px; }
        .gauge-seg { height: 100%; }
        .seg-good { background-color: var(--gauge-good); border-radius: 3px 0 0 3px; } .seg-warn { background-color: var(--gauge-warn); } .seg-poor { background-color: var(--gauge-bad); border-radius: 0 3px 3px 0; }
        .seg-rev-poor { background-color: var(--gauge-bad); border-radius: 3px 0 0 3px; } .seg-rev-warn { background-color: var(--gauge-warn); } .seg-rev-good { background-color: var(--gauge-good); border-radius: 0 3px 3px 0; }
        .gauge-marker { position: absolute; top: -2px; width: 2px; height: 9px; background-color: var(--text-main); border: 1px solid var(--bg-card); transform: translateX(-50%); z-index: 2; transition: left 0.5s ease; }

        .loading { grid-column: 1 / -1; text-align: center; padding: 20px; color: var(--text-sub); font-size: 1rem; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); }
        .modal-content { background-color: var(--bg-card); color: var(--text-main); margin: 3% auto; padding: 15px; border-radius: 8px; width: 95%; max-width: 1100px; max-height: 95vh; overflow-y: auto; display: flex; flex-direction: column; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid var(--border-color); }
        .close-btn { font-size: 1.5rem; cursor: pointer; color: var(--text-sub); }
        .chart-controls { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px; background: var(--bg-body); padding: 8px; border-radius: 5px; align-items: center; }
        .control-group { display: flex; flex-direction: column; min-width: 100px; flex: 1; }
        .control-group label { font-size: 0.75rem; color: var(--text-sub); margin-bottom: 3px; font-weight: bold; }
        select { padding: 4px; border-radius: 4px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-main); font-size: 0.85rem; }
        .checkbox-list { max-height: 80px; overflow-y: auto; border: 1px solid var(--border-color); background: var(--bg-card); padding: 4px; border-radius: 4px; }
        .checkbox-item { display: flex; align-items: center; font-size: 0.8rem; margin-bottom: 2px; color: var(--text-main); }
        .checkbox-item input { margin-right: 5px; }
        .chart-container { position: relative; height: 450px; width: 100%; } 
        
        /* 報表表格樣式 */
        .report-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; color: #000; background: #fff; }
        .report-table th, .report-table td { border: 1px solid black; padding: 6px; text-align: center; }
        .report-table th { background-color: #f0f0f0; font-weight: bold; }
        .report-title { font-size: 1.5rem; font-weight: bold; text-align: center; margin-bottom: 5px; color: #000; }
        .report-subtitle { font-size: 1rem; text-align: center; margin-bottom: 15px; color: #000; }
        /* 修正 Footer 樣式 (置中 + 間距) */
        .report-footer { margin-top: 30px; display: flex; justify-content: center; gap: 80px; font-size: 1rem; color: #000; }

        @media (max-width: 600px) { #app { grid-template-columns: 1fr; } h1 { font-size: 1rem; } .value { font-size: 1.1rem; } .modal-content { margin: 10% auto; width: 95%; padding: 15px; } .chart-controls { flex-direction: column; } }
    </style>
